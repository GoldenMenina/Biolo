(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[189],{7257:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var n=r(9499),a=r(29),s=r(7794),o=r.n(s),c=r(7294),i=r(6490),u=r(5893);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p=(0,i.eI)("https://tmxloojyhptewicelujm.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRteGxvb2p5aHB0ZXdpY2VsdWptIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjA4NjgyMDYsImV4cCI6MjAzNjQ0NDIwNn0.9mYoFRr1Mlo02DD2haZ1jnKXA1_XCzkh9pMfMa2xVf0");function h(){var e=(0,c.useState)([]),t=e[0],r=e[1],n=(0,c.useState)(),s=n[0],i=n[1],l=(0,c.useState)(!1),h=l[0],m=l[1],f=(0,c.useState)(""),x=f[0],v=f[1],j=(0,c.useState)(""),b=j[0],g=j[1],y=(0,c.useState)(!1),N=y[0],w=y[1],C=(0,c.useState)(""),k=C[0],S=C[1],I=(0,c.useState)(""),O=I[0],P=I[1],E=(0,c.useState)(!1),Z=E[0],_=E[1];function A(){return D.apply(this,arguments)}function D(){return(D=(0,a.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.auth.getSession();case 2:t=e.sent,t.data.session&&w(!0);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(){return(z=(0,a.Z)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,p.auth.signInWithPassword({email:k,password:O});case 3:r=e.sent,r.data,r.error?alert("Invalid credentials"):w(!0);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(){return(J=(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.auth.signOut();case 2:w(!1);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,c.useEffect)((function(){G()}),[]),(0,c.useEffect)((function(){A()}),[]);var X=(0,c.useState)({corte:"",preco:"",categoria:"",image:null}),B=X[0],M=X[1],T=(0,c.useState)(null),q=T[0],F=T[1],Y=(0,c.useState)(!1),V=Y[0],L=Y[1];(0,c.useEffect)((function(){G()}),[]);var R=t.filter((function(e){var t=e.corte.toLowerCase().includes(x.toLowerCase()),r=""===b||e.categoria===b;return t&&r}));function G(){return Q.apply(this,arguments)}function Q(){return(Q=(0,a.Z)(o().mark((function e(){var t,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.from("produtos").select("*");case 2:t=e.sent,n=t.data,(a=t.error)?console.error("Erro ao carregar produtos:",a):r(n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return(W=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),_(!0),!q){e.next=7;break}return e.next=5,te();case 5:e.next=9;break;case 7:return e.next=9,$();case 9:_(!1),L(!1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(){return(H=(0,a.Z)(o().mark((function e(t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(q&&m(!0),r=t.target.files[0]){e.next=4;break}return e.abrupt("return");case 4:(n=new FormData).append("file",r),n.append("upload_preset","utjuauqd"),i(n);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(){return U.apply(this,arguments)}function U(){return(U=(0,a.Z)(o().mark((function e(){var t,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.cloudinary.com/v1_1/dbagu0ju8/image/upload",{method:"POST",body:s});case 2:return t=e.sent,e.next=5,t.json();case 5:return r=e.sent,e.abrupt("return",r.secure_url);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){return ee.apply(this,arguments)}function ee(){return(ee=(0,a.Z)(o().mark((function e(){var t,r,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K();case 2:return t=e.sent,e.next=5,p.from("produtos").insert([{corte:B.corte,preco:B.preco,categoria:B.categoria,image:t}]);case 5:r=e.sent,n=r.data,(a=r.error)?console.error("Erro ao adicionar produto:",a):(console.log("Produto adicionado:",n),G(),M({corte:"",preco:"",categoria:"",image:null}));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(){return re.apply(this,arguments)}function re(){return(re=(0,a.Z)(o().mark((function e(){var t,r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(q){e.next=2;break}return e.abrupt("return");case 2:if(t="",!h){e.next=8;break}return e.next=6,K();case 6:t=e.sent,ne("img",q.image);case 8:return e.next=10,p.from("produtos").update({corte:q.corte,preco:q.preco,categoria:q.categoria,image:h?t:q.image}).eq("id",q.id);case 10:r=e.sent,(n=r.error)?console.error("Erro ao atualizar produto:",n):(console.log("Produto atualizado"),G(),F(null),m(!1));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(e,t){return ae.apply(this,arguments)}function ae(){return(ae=(0,a.Z)(o().mark((function e(t,r){var n,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=10;break}return n=r.split("/").pop().split(".")[0],e.prev=2,e.next=5,fetch("/api/deleteImage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({publicId:n})});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.error("Erro ao deletar imagem do Cloudinary:",e.t0);case 10:if("img"==t){e.next=16;break}return e.next=13,p.from("produtos").delete().eq("id",t);case 13:a=e.sent,(s=a.error)?console.error("Erro ao deletar produto:",s):G();case 16:case"end":return e.stop()}}),e,null,[[2,7]])})))).apply(this,arguments)}function A(){return se.apply(this,arguments)}function se(){return(se=(0,a.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.auth.getSession();case 2:t=e.sent,t.data.session&&w(!0);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,c.useEffect)((function(){A()}),[]),N?(0,u.jsxs)("div",{className:"container mt-5",children:[(0,u.jsxs)("button",{className:"btn btn-danger btn-sm",onClick:function(){return J.apply(this,arguments)},children:[(0,u.jsx)("i",{className:"fas fa-sign-out-alt"})," Terminar Sess\xe3o"]}),(0,u.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,u.jsx)("h1",{children:"Administra\xe7\xe3o de Produtos"}),(0,u.jsx)("button",{className:"btn btn-primary",onClick:function(){F(null),M({corte:"",preco:"",categoria:"",image:null}),L(!0)},children:"Novo Produto"})]}),(0,u.jsxs)("div",{className:"mb-3 row",children:[(0,u.jsx)("div",{className:"col",children:(0,u.jsx)("input",{type:"text",className:"form-control",placeholder:"Buscar por corte",value:x,onChange:function(e){return v(e.target.value)}})}),(0,u.jsx)("div",{className:"col",children:(0,u.jsxs)("select",{className:"form-control",value:b,onChange:function(e){return g(e.target.value)},children:[(0,u.jsx)("option",{value:"",children:"Todos"}),(0,u.jsx)("option",{value:"Bovinos",children:"Bovinos"}),(0,u.jsx)("option",{value:"Su\xednos",children:"Su\xednos"}),(0,u.jsx)("option",{value:"Aves",children:"Aves"}),(0,u.jsx)("option",{value:"Caprinos",children:"Caprinos"}),(0,u.jsx)("option",{value:"Caixas",children:"Caixas"})]})})]}),(0,u.jsxs)("table",{className:"table",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"Corte"}),(0,u.jsx)("th",{children:"Pre\xe7o"}),(0,u.jsx)("th",{children:"Categoria"}),(0,u.jsx)("th",{children:"Imagem"}),(0,u.jsx)("th",{children:"A\xe7\xf5es"})]})}),(0,u.jsx)("tbody",{children:R.map((function(e){return(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:e.corte}),(0,u.jsx)("td",{children:e.preco}),(0,u.jsx)("td",{children:e.categoria}),(0,u.jsx)("td",{children:e.image&&(0,u.jsx)("img",{src:e.image,alt:e.corte,style:{width:"50px",height:"50px"}})}),(0,u.jsxs)("td",{children:[(0,u.jsx)("button",{className:"btn btn-sm btn-warning me-2",onClick:function(){return function(e){F(d(d({},e),{},{originalImage:e.image})),L(!0)}(e)},children:"Editar"}),(0,u.jsx)("button",{className:"btn btn-sm btn-danger",onClick:function(){return ne(e.id,e.image)},children:"Eliminar"})]})]},e.id)}))})]}),(0,u.jsx)("div",{className:"modal ".concat(V?"show":""),style:{display:V?"block":"none"},children:(0,u.jsx)("div",{className:"modal-dialog",children:(0,u.jsxs)("div",{className:"modal-content",children:[(0,u.jsxs)("div",{className:"modal-header",children:[(0,u.jsx)("h5",{className:"modal-title",children:q?"Editar Produto":"Inserir Novo Produto"}),(0,u.jsx)("button",{type:"button",className:"btn-close",onClick:function(){return L(!1)}}),(0,u.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:function(){return L(!1)},children:"Fechar"})]}),(0,u.jsx)("div",{className:"modal-body",children:(0,u.jsxs)("form",{onSubmit:function(e){return W.apply(this,arguments)},children:[(0,u.jsx)("div",{className:"mb-3",children:(0,u.jsx)("input",{type:"text",className:"form-control",placeholder:"Corte",value:q?q.corte:B.corte,onChange:function(e){return q?F(d(d({},q),{},{corte:e.target.value})):M(d(d({},B),{},{corte:e.target.value}))}})}),(0,u.jsx)("div",{className:"mb-3",children:(0,u.jsx)("input",{type:"number",className:"form-control",placeholder:"Pre\xe7o",value:q?q.preco:B.preco,onChange:function(e){return q?F(d(d({},q),{},{preco:e.target.value})):M(d(d({},B),{},{preco:e.target.value}))}})}),(0,u.jsx)("div",{className:"mb-3",children:(0,u.jsxs)("select",{className:"form-control",value:q?q.categoria:B.categoria,onChange:function(e){return q?F(d(d({},q),{},{categoria:e.target.value})):M(d(d({},B),{},{categoria:e.target.value}))},children:[(0,u.jsx)("option",{value:"",children:"Selecione uma categoria"}),(0,u.jsx)("option",{value:"Bovinos",children:"Bovinos"}),(0,u.jsx)("option",{value:"Su\xednos",children:"Su\xednos"}),(0,u.jsx)("option",{value:"Aves",children:"Aves"}),(0,u.jsx)("option",{value:"Caprinos",children:"Caprinos"}),(0,u.jsx)("option",{value:"Caixas",children:"Caixas"})]})}),(0,u.jsx)("div",{className:"mb-3",children:(0,u.jsx)("input",{type:"file",className:"form-control",onChange:function(e){return H.apply(this,arguments)},accept:"image/*"})}),Z?(0,u.jsx)("button",{className:"btn btn-primary disabled",children:"Aguarde ..."}):(0,u.jsxs)("button",{type:"submit",className:"btn btn-primary",children:[q?"Atualizar":"Adicionar"," Produto"]})]})})]})})}),V&&(0,u.jsx)("div",{className:"modal-backdrop fade show"})]}):(0,u.jsx)("div",{className:"modal d-block",tabIndex:"-1",style:{backgroundColor:"rgba(0,0,0,0.5)"},children:(0,u.jsx)("div",{className:"modal-dialog modal-dialog-centered",children:(0,u.jsxs)("div",{className:"modal-content",children:[(0,u.jsx)("div",{className:"modal-header",children:(0,u.jsx)("h5",{className:"modal-title",children:"Iniciar Sess\xe3o"})}),(0,u.jsx)("div",{className:"modal-body",children:(0,u.jsxs)("form",{onSubmit:function(e){return z.apply(this,arguments)},children:[(0,u.jsx)("div",{className:"mb-3 text-center",children:(0,u.jsx)("i",{className:"fas fa-user fa-3x"})}),(0,u.jsx)("div",{className:"mb-3",children:(0,u.jsx)("input",{type:"email",className:"form-control",placeholder:"Email",value:k,onChange:function(e){return S(e.target.value)},required:!0})}),(0,u.jsx)("div",{className:"mb-3",children:(0,u.jsx)("input",{type:"password",className:"form-control",placeholder:"Password",value:O,onChange:function(e){return P(e.target.value)},required:!0})}),(0,u.jsx)("button",{type:"submit",className:"btn btn-primary w-100",children:"Iniciar Sess\xe3o"})]})})]})})})}},4737:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/dashboard",function(){return r(7257)}])}},function(e){e.O(0,[638,774,888,179],(function(){return t=4737,e(e.s=t);var t}));var t=e.O();_N_E=t}]);